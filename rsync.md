## Основы rsync - инструкция по синхронизации локального рабочего каталога с рабочим каталогом веб-сайта

Утилита rsync должна быть установлена на всех машинах, на локальной и на сервере.

В **rsync** всегда, сначала указываем **источник**, а потом **место назначения**, т.е сначала что копируем, а потом куда копируем.  
Всегда используйте **параметр -nv перед прогоном**. Rsync может натворить огромную головную боль если что-то не так сделать.

### Завершающий слеш "/"
Надо быть особо внимательным при указании каталога источника (того что копируем).

Источник *без завершающего слеша скопирует сам каталог* `/path/dir` в удаленный каталог `/dest_dir`:
```
$ rsync -a /path/dir user@host:dest_dir
```

Путь к каталогу источнику *с косой чертой в конце* скопирует *не сам каталог* `/path/dir`, а все содержимое в удаленный
каталог `/dest_dir`:
```
$ rsync -a /path/dir/ user@host:dest_dir
```

### Параметры

Параметр **-e "ssh -p 222**. Внимание: если вы коннектитесь по ssh через свой порт, добавляйте в команду rsync этот параметр.  
Скопировать файл на удаленный хост:
```
rsync -e "ssh -p 222" file.txt user@host:
```
Обратите внимание: двоеточие в конце `host:` (в конце места назначения) указывает домашний каталог, file.txt будет скопирован именно в домашний каталог пользователя user.

Скопировать в каталог `home/user/dir/`, если каталога нет, создаст этот каталог:
```
rsync -a -e "ssh -p 673" test_rsync/ user@host:dir
```

**Параметр *-a***. Передать всю иерархию каталога (все символические ссылки, права доступа, режимы файлов).
```
 rsync -a -e "ssh -p 673" /path/dir/ user@host:dir
```

**Параметр *--exclude***. Исключить каталог из операции переноса:
```
rsync -a -e "ssh -p 7967" --exclude 'assets/css' html/ user@host:html/
```

**Параметр *--delete**. Создать точную структуру каталога-источника. Удалит из каталога-назначения всё лишнее
```
rsync -a --delete -e "ssh -p 222" test/ user@host:test/
```

**Параметры -n**. Режим пробного прогона.

**Параметр -v**. Подробный режим, отображает все детали.

```
rsync -nva --delete -e "ssh -p 222" test/ user@host:test/
```
    